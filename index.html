<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>醫療綜合釋疑小幫手 (Medical Query Router)</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="app-container">
        <!-- 左半邊：後端運行終端機 -->
        <div class="left-pane">
            <div class="terminal-header">
                <span class="dot red"></span>
                <span class="dot yellow"></span>
                <span class="dot green"></span>
                <span class="terminal-title">Backend Terminal Simulator</span>
            </div>
            <div class="terminal-content" id="terminal-content">
                <div class="log-line system-log">Waiting for requests...</div>
            </div>
        </div>

        <!-- 右半邊：使用者互動區 -->
        <div class="right-pane">
            <div class="chat-header" style="padding-bottom: 10px;">
                <h1 style="margin-bottom: 5px; font-size: 1.5em;">醫療綜合釋疑小幫手 (DEMO)</h1>
                <p style="font-size: 12px; margin-bottom: 8px; color: #555;">開發者：陳劭杰 0919848191 | Powered by Semantic
                    Kernel & OpenRouter/Groq (免費額度)</p>
                <div class="warning-banner"
                    style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; padding: 6px 10px; background-color: #fff3cd; border-radius: 4px; border: 1px solid #ffeeba; font-size: 11px; color: #856404; margin: 0 auto; max-width: 95%;">
                    <strong>⚠️ 聲明與警語：</strong>
                    <span>1. 非正式醫療診斷，僅供衛教參考。</span>
                    <span>2. 測試環境，請勿送出任何真實隱私或敏感資訊。</span>
                    <span>3. 免費 AI 輸出穩定性受限。</span>
                    <span style="color: #d9534f; font-weight: bold;">4. 免費 API 可能無回應或出錯，請稍後再試。</span>
                </div>
            </div>



            <!-- 對話介面 -->
            <div class="chat-container">
                <div class="messages-area" id="messages-area">
                    <div class="message system-message markdown-body">
                        您好！請問有什麼我可以協助您的？（支援報告解讀、用藥疑問等）
                    </div>

                    <!-- 隱藏的載入中動畫 -->
                    <div id="loading-indicator" class="message system-message loading-indicator" style="display: none;">
                        <span class="dot"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                    </div>
                </div>



                <div class="input-area">
                    <!-- 警告標語已整合至上方標題 -->

                    <div class="model-selector-container"
                        style="margin-bottom: 10px; display: flex; align-items: center; gap: 10px;">
                        <label for="model-select" style="font-weight: bold; color: var(--primary-color);">選擇 AI
                            模型：</label>
                        <select id="model-select"
                            style="flex: 1; padding: 6px; border-radius: 4px; border: 1px solid #ccc;">
                            <option value="openrouter:arcee-ai/trinity-large-preview:free">OpenRouter:
                                arcee-ai/trinity-large-preview:free</option>
                            <option value="openrouter:openai/gpt-oss-120b:free">OpenRouter: openai/gpt-oss-120b:free
                            </option>
                            <option value="groq:openai/gpt-oss-120b">Groq: openai/gpt-oss-120b</option>
                            <option value="groq:meta-llama/llama-4-scout-17b-16e-instruct" selected>Groq:
                                meta-llama/llama-4-scout-17b-16e-instruct</option>
                        </select>
                    </div>

                    <div class="input-form">
                        <div class="textarea-container" style="flex:1; position:relative;">
                            <textarea id="user-input" placeholder="請輸入您的醫療問題..." rows="3"
                                style="width:100%; height:100%; box-sizing:border-box;"></textarea>
                            <button id="clear-input-btn" class="clear-btn" title="清空對話框">✕</button>
                        </div>
                        <button id="send-btn" class="primary-btn">發送 🚀</button>
                    </div>
                </div>
            </div>

            <!-- 測試面板 (移至最下方) -->
            <div class="test-panel">
                <div class="test-panel-header" id="test-panel-toggle">
                    <span>🔬 自動測試面板 (點擊收合)</span>
                    <span id="toggle-icon">▲</span>
                </div>
                <div class="test-panel-content" id="test-panel-content">
                    <div class="test-panel-row">
                        <span style="font-weight:bold; color:var(--primary-color);">問題生產器</span>
                        <input type="text" id="gen-direction-input" placeholder="輸入問題生成方向..."
                            style="flex:1; padding: 6px; border-radius: 4px; border: 1px solid #ccc;" />
                        <button id="generate-btn" class="secondary-btn">🎲 生成</button>
                        <button id="save-generated-btn" class="secondary-btn">💾 存入列表</button>
                    </div>
                    <div class="test-panel-row">
                        <select id="test-case-select" style="flex:1;">
                            <option value="">-- 自訂與預設問題列表 --</option>
                        </select>
                    </div>
                    <div class="test-panel-row" style="justify-content: flex-start; gap: 10px;">
                        <button id="auto-test-btn" class="secondary-btn">🤖 全自動測試</button>
                        <button id="new-chat-btn" class="secondary-btn">🗑️ 新對話</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="app.js"></script>
</body>

</html>